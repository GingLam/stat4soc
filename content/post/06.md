---
date: "2021-08-01T18:05:05-05:00"
tags:
- 专题研究
- 社会不平等
- 基尼系数
- SPSS
title: 第六节 专题研究：当代中国的社会不平等
---

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

#### 0. 预处理
*   **设置工作目录**：
```spss
CD "/Users/ginglam/Public/data".
```
*   **导入2016年中国劳动力动态调查数据 (CLDS)**：
```spss
GET FILE "clds2016_i.sav".
DATASET NAME clds.
DATASET ACTIVATE clds.
```

#### 1. 理解基尼系数
*   基尼系数 (Gini Coefficient) 是意大利统计学家基尼 (Corrado Gini) 在1912年提出的一种核心指标，用于衡量一个国家或地区居民收入分布的差异程度，是衡量社会不平等度的重要工具。

![基尼画像](https://stat4soc.netlify.app/images/6.1.jpg)

*   **基尼系数的内涵**
	*   它通过一个简洁的数字（取值在0到1之间），概括了收入在全体人口中的分配情况。
	*   基尼系数为 **0**，代表**完全平等**。可以想象一个社会，其中每个人的收入都完全相同，没有任何差异。
	*   基尼系数为 **1**，代表**完全不平等**。可以想象一个极端社会，其中一个人占有了所有的社会财富，而其他所有人收入为零。
	*   现实社会总是处于这两个极端之间。基尼系数的数值越大，表明该地区的收入不平等程度越高。

#### 2. 基尼是如何构想出基尼系数的？
*   基尼系数的构想，建立在美国统计学家劳伦兹 (Max Lorenz) 提出的**劳伦兹曲线 (Lorenz Curve)** 之上。
*   劳伦兹曲线是一个描述人口累计百分比和收入累计百分比之间关系的图形。

    ![坐标轴](https://stat4soc.netlify.app/images/6.201.png)

*   在一个坐标系中
    *   **绝对平等线 (Line of Perfect Equality)**：一条45度角直线。它表示“x%的人口”拥有“x%的社会财富”。例如，10%的人口拥有10%的财富，50%的人口拥有50%的财富。这是收入分配最平等的状态。
    ![绝对平等线](https://stat4soc.netlify.app/images/6.3.png)
    *   **劳伦兹曲线 (Lorenz Curve)**：将社会中所有人口按收入从低到高排序后，绘制出的“人口累计百分比”与他们所拥有的“收入累计百分比”的关系曲线。在现实中，这条线总是弯向右下方的，因为低收入人口占有的财富比例总是低于其人口比例。
    ![劳伦兹曲线](https://stat4soc.netlify.app/images/6.4.png)

*   **基尼系数的计算**
    *   基尼系数在几何上被定义为：**绝对平等线与劳伦兹曲线所围成的面积A**，占**绝对平等线与坐标轴所围成的总面积(A+B)** 的比例。
    *   由于(A+B)的总面积恒为0.5，所以基尼系数也可以表示为 `Gini = A / 0.5 = 2A`。
    ![面积A与B](https://stat4soc.netlify.app/images/6.501.png)
    *   面积A越大，表示劳伦兹曲线偏离绝对平等线越远，即收入分配越不平等，基尼系数也越大。
    ![两个极端](https://stat4soc.netlify.app/images/6.71.png)

#### 3. 全球比较下的基尼系数
*   **联合国开发计划署 (UNDP)** 提供了一个普遍接受的参考标准：
	*   **< 0.2**：收入绝对平均，不平等状况**极低**。
	*   **0.2 - 0.3**：比较平均，不平等状况**较低**。
	*   **0.3 - 0.4**：相对合理，不平等状况**中等**。
	*   **0.4 - 0.5**：差距较大，不平等状况**较高**。
	*   **> 0.5**：差距悬殊，不平等状况**极高**。
*   通常，**0.4** 被视为收入分配差距的“警戒线”。
*   **中国的基尼系数**：根据学术研究（如 Xie & Zhou, 2014, PNAS），中国的基尼系数在改革开放后经历了快速上升，近年来一直处于较高水平。
 ![中国基尼系数趋势](https://stat4soc.netlify.app/images/6.91.png)

#### 4. 在SPSS中计算收入基尼系数
*   **计算前的准备工作**
	*   **变量类型**：用于计算的变量必须是定距或定比变量（如收入、财富、教育年限）。
	*   **负数处理**：基尼系数的计算不接受负值。必须筛选掉或处理好收入为负的个案。
	*   **缺失值处理**：必须排除缺失值个案。
*   **基尼系数的计算公式与SPSS实现思路**
    我们将介绍两种等价的计算方法。
*   **方法一：基于累积份额的公式**
    $$ G = 1 - \sum_{k=1}^{N} (p_k \cdot (2 \cdot CP_k - P_k)) $$
    其中，\\(N\\)是总人口, \\(p_k\\)是每个人的权重(通常是1/N), \\(P_k\\)是每个人的收入占总收入的份额, \\(CP_k\\)是按收入排序后，到第k个人的累积收入份额。
*   **方法二：基于排序的布朗公式 (Brown Formula)**
    $$ G = \left| 1 - \frac{2}{N-1} \sum_{k=1}^{N} \frac{N-k+1}{N} \cdot \frac{y_k}{\bar{y}} \right| $$
    一个更便于程序计算的简化形式是：
    $$ G = \frac{2 \sum_{i=1}^{N} i \cdot y_i}{N \sum_{i=1}^{N} y_i} - \frac{N+1}{N} $$
    其中，\\(y_i\\)是按升序排列后第\\(i\\)个人的收入，\\(N\\)是总人口。

#### 5. SPSS实现：方法一（累积份额法）
*   **核心思路**：先用 `AGGREGATE` 命令计算出总体层面的统计量（总人数、总收入），并将其添加回每个个案，然后进行个体层面的计算。

```spss
* --- 准备工作：创建一个干净的数据集用于计算 ---
DATASET DECLARE gini_temp.
AGGREGATE
  /OUTFILE='gini_temp'
  /BREAK
  /I3a_6_clean=MAX(I3a_6). /* 这是一个小技巧，先创建一个只有一个值的临时文件 */

DATASET ACTIVATE clds.
* --- 步骤一：筛选出收入为非负数的有效个案 ---
SELECT IF (I3a_6 >= 0).

* --- 步骤二：计算总人数和总收入，并将其作为新变量添加回每个个案 ---
AGGREGATE
  /OUTFILE=* MODE=ADDVARIABLES
  /BREAK
  /total_num '总样本量' = N
  /total_income '总收入' = SUM(I3a_6).
EXECUTE.

* --- 步骤三：按收入对个案进行升序排序 ---
SORT CASES BY I3a_6 (A).

* --- 步骤四：计算每个人的权重(p)和收入份额(P) ---
COMPUTE id_weight = 1 / total_num.
COMPUTE income_share = I3a_6 / total_income.

* --- 步骤五：计算收入的累积份额(CP) ---
* CSUM函数需要数据预先排序，我们已在步骤三完成.
COMPUTE cum_income_share = CSUM(income_share).

* --- 步骤六：应用基尼系数公式的求和部分 ---
COMPUTE gini_part = id_weight * (2 * cum_income_share - income_share).

* --- 步骤七：对所有人的计算部分求和，并得出最终基尼系数 ---
AGGREGATE
  /OUTFILE='gini_temp'
  /BREAK
  /sum_gini_part = SUM(gini_part).

DATASET ACTIVATE gini_temp.
COMPUTE gini_method1 = 1 - sum_gini_part.
FORMATS gini_method1 (F10.8).
LIST gini_method1.
EXECUTE.
```
> **优化说明**：
> 上述代码流程经过了优化，通过 `MODE=ADDVARIABLES` 避免了反复创建和匹配临时文件，效率更高。最后的计算结果会保存在一个名为`gini_temp`的新数据集中。

#### 6. SPSS实现：方法二（排序法）
*   **核心思路**：该方法更直接，利用排序后的行号 `($casenum)` 作为公式中的排序编号 `i`。

```spss
* --- 准备工作：确保使用干净的原始数据 ---
DATASET ACTIVATE clds.

* --- 步骤一：筛选出收入为非负数的有效个案 ---
SELECT IF (I3a_6 >= 0).

* --- 步骤二：按收入对个案进行升序排序 ---
SORT CASES BY I3a_6 (A).

* --- 步骤三：计算所需的总体统计量和个体层面的加权值 ---
* 计算总样本量 N
* 计算总收入 Sum(y)
* 计算加权收入 i * y_i
COMPUTE case_num = $casenum.
COMPUTE weighted_income = case_num * I3a_6.

* --- 步骤四：一次性聚合所有需要的总和项 ---
* 使用 AGGREGATE 创建一个只包含最终结果的新数据集
DATASET DECLARE gini_result.
AGGREGATE
  /OUTFILE='gini_result'
  /BREAK
  /N = N
  /Total_Income = SUM(I3a_6)
  /Total_Weighted_Income = SUM(weighted_income).
EXECUTE.

* --- 步骤五：在新数据集中应用公式计算基尼系数 ---
DATASET ACTIVATE gini_result.
COMPUTE gini_method2 = (2 * Total_Weighted_Income / (N * Total_Income)) - ((N+1)/N).
FORMATS gini_method2 (F10.8).
LIST gini_method2.
EXECUTE.
```
> **方法比较**：
> 两种方法在数学上是等价的，计算结果应该非常接近。方法二在SPSS中的实现更为简洁高效。

#### 随堂练习：计算教育年限的基尼系数
*   **任务**：使用 `I2_1` 变量，先将其转换为教育年限，然后计算教育资源分配的基尼系数。
*   **编码规则**：
	*   未上过学 -> 0年
	*   小学/私塾 -> 6年
	*   初中 -> 9年
	*   普通高中/职业高中/技校/中专 -> 12年
	*   大专 -> 15年
	*   大学本科 -> 16年
	*   硕士 -> 19年
	*   博士 -> 22年
> **练习参考答案**
> ```spss
> DATASET ACTIVATE clds.
> * 步骤一：将学历重新编码为教育年限.
> RECODE I2_1 (1=0) (2=6) (3=9) (4 THRU 7=12) (8=15) (9=16) (10=19) (11=22) (ELSE=SYSMIS) INTO edu_year.
> VARIABLE LABELS edu_year "教育年限".
>
> * 步骤二：使用方法二计算教育年限的基尼系数.
> SELECT IF (edu_year >= 0).
> SORT CASES BY edu_year (A).
> COMPUTE case_num = $casenum.
> COMPUTE weighted_edu = case_num * edu_year.
>
> DATASET DECLARE edu_gini_result.
> AGGREGATE
>  /OUTFILE='edu_gini_result'
>  /BREAK
>  /N = N
>  /Total_Edu = SUM(edu_year)
>  /Total_Weighted_Edu = SUM(weighted_edu).
> EXECUTE.
>
> DATASET ACTIVATE edu_gini_result.
> COMPUTE gini_edu = (2 * Total_Weighted_Edu / (N * Total_Edu)) - ((N+1)/N).
> FORMATS gini_edu (F10.8).
> LIST gini_edu.
> EXECUTE.
> ```

#### 附注：使用Stata软件进行快捷计算
> **辅助知识点：专业软件的优势**
> 虽然在SPSS中通过手动编写语法可以深入理解计算过程，但像Stata这类统计软件通常内置了专门的命令，可以一键完成劳伦兹曲线绘制和基尼系数计算，大大提高了效率。了解这些工具，可以让我们把更多精力放在结果的解读上。

*   以下为Stata命令，请勿在SPSS中运行。
*   **读取数据**
```stata
cd "/Users/ginglam/Public/data"
import spss using "clds2016_i.sav", clear
```
*   **安装相关命令** (只需安装一次)
```stata
ssc install inequal7, replace
ssc install lorenz, replace
```
*   **绘制劳伦兹曲线**
```stata
lorenz I3a_6
```
![Stata劳伦兹曲线](https://stat4soc.netlify.app/images/6.23.png)
*   **计算基尼系数及其他不平等指数**
```stata
inequal7 I3a_6
```
![Stata基尼系数计算结果](https://stat4soc.netlify.app/images/6.24.png)
