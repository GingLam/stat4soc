---
date: "2021-08-01T21:05:05-05:00"
tags:
- 问卷录入
- SPSS
- Syntax
title: 第三节 问卷编码与数据录入（二）
---

#### 13. 处理多选题 (Multiple Choice Question)
*   问卷中的多选题，在数据录入时需要进行转换。最常用、最规范的方法是“多重二分法”，即将一个多选题拆解成多个“是/否”型的单选题。每个选项都成为一个独立的变量。

#### 案例（13-1）：将以下多选题录入SPSS
*   *您主要通过何种途径了解国际新闻____（可多选）: A.报纸 B.杂志 C.广播 D.电视 E.电脑 F.手机 G.其他*
*   **转换思路：** 将其转换为七个独立的、回答为“是”或“否”的变量。
	*   您是否通过“报纸”了解国际新闻？ (是/否)
	*   您是否通过“杂志”了解国际新闻？ (是/否)
	*   ... 以此类推 ...
*   **语法实现：**
```spss
* 建议使用数字型(Numeric)而非字符串型(String)来处理，便于后续统计分析.
* F1.0 表示宽度为1位的整数.
NUMERIC news1 news2 news3 news4 news5 news6 news7 (F1.0).

* 为每个新变量添加详细的变量标签.
VARIABLE LABELS 
    news1 "途径：报纸" / 
    news2 "途径：杂志" /
    news3 "途径：广播" /
    news4 "途径：电视" /
    news5 "途径：电脑" /
    news6 "途径：手机" /
    news7 "途径：其他".

* 为所有这些变量统一定义值标签：0代表未选中，1代表选中.
VALUE LABELS news1 TO news7 0 "否" 1 "是".

* 定义这些变量的测量级别为名义变量.
VARIABLE LEVEL news1 TO news7 (NOMINAL).

EXECUTE.
```

![处理多选题](https://stat4soc.netlify.app/images/3.1.png)

#### 14. 定义与处理缺失值 (Missing Value)
*   **缺失值**是指数据集中由于某种原因而未能记录到的值。在SPSS中，缺失值分为两类：
    *   **系统缺失值 (System-Missing Value):** 指数据单元格中完全没有任何输入，SPSS会以一个点 `.` 来表示。这是默认的缺失状态。
    *   **用户自定义缺失值 (User-Defined Missing Value):** 指由研究者自行指定某个或某些特定数值来代表缺失，例如用 `99` 代表“不知道”，用 `-9` 代表“拒绝回答”等。这样做的好处是可以区分不同原因的缺失。
*   **点选操作：** 变量视图 → 点击目标变量所在行的“缺失”列 → 在弹出窗口中设定离散值（如 `99`）或范围。
*   **语法操作：** `MISSING VALUES` + 变量名 + `(值或范围)`.

#### 案例（14-1）：将以下问题录入SPSS并处理缺失值
*   Q1. 您如何看待电商采集用户信息进行精准广告投放？ A.支持 B.理解 C.反对 D.说不清楚
*   Q2. 平均而言，您每个月在所有电商平台上花多少钱？ _____
*   **缺失情况分析：**
	*   对于Q1，选项 D "说不清楚" 在分析时可能不作为有效态度，可定义为用户自定义缺失值。
	*   对于Q2，受访者可能拒绝回答（留空，成为系统缺失值），或填写了无意义的负数。这些都应被视为缺失。
```spss
* 为Q1创建数字型变量ad，为Q2创建consume.
NUMERIC ad(F1.0) consume(F10.2). 

* 添加变量标签.
VARIABLE LABELS 
    ad "您如何看待电商采集用户信息进行精准广告投放" /
    consume "平均而言，您每个月在所有电商平台上花多少钱".

* 添加值标签.
VALUE LABELS ad 1 "支持" 2 "理解" 3 "反对" 4 "说不清楚".

* 定义测量级别.
VARIABLE LEVEL ad (NOMINAL) / consume (SCALE).

* 定义缺失值.
* 对于ad变量，将数值4（"说不清楚"）定义为缺失值.
* 对于consume变量，将从系统最小值(lo)到0的所有值，以及一个特殊的大数9999999999定义为缺失值.
MISSING VALUES ad (4) consume (LO THRU 0, 9999999999).

EXECUTE.
```

![定义缺失值](https://stat4soc.netlify.app/images/3.2.png)

*   **补充说明：** 如果在某个研究中，消费金额 `0` 是一个有效值（代表确实没有花费），而非缺失，那么缺失值范围应设置为不包含0。
```spss
* 将从最小值(lo)到任何小于0的数(例如-0.001)都定义为缺失.
MISSING VALUES consume (LO THRU -0.001, 9999999999).
```

![0为有效值的缺失值处理](https://stat4soc.netlify.app/images/3.3.png)

#### 15. 处理跳答题 (Skip Pattern / Conditional Question)
*   跳答题是指受访者根据对某一题的回答，跳过后续部分题目。这会导致被跳过题目的数据自然缺失。

#### 案例（15-1）：将以下含跳答逻辑的问卷录入SPSS
*   Q1. 您平时是否会在电商平台上买东西？ A.是 B.否 (如选B，则跳过Q2和Q3)
*   Q2. 您平时会选择在哪个电商平台上买东西？ (可多选) A.淘宝/天猫 B.京东 ...
*   Q3. 平均而言，您每个月在所有电商平台上花多少钱？ _____

```spss
* 创建变量. ol_shopping是关键的甄别问题.
NUMERIC ol_shopping (F1.0).
NUMERIC e_commerce1 e_commerce2 e_commerce3 e_commerce4 e_commerce5 e_commerce6 (F1.0).
NUMERIC consume (F10.2).

* 添加变量标签.
VARIABLE LABELS 
	ol_shopping "Q1: 您平时是否会在电商平台上买东西" /
	e_commerce1 "Q2a: 平台-淘宝/天猫" /
	e_commerce2 "Q2b: 平台-京东" /
	e_commerce3 "Q2c: 平台-拼多多" /
	e_commerce4 "Q2d: 平台-微店" /
	e_commerce5 "Q2e: 平台-Amazon" /
	e_commerce6 "Q2f: 平台-其他" /
	consume "Q3: 平均每月电商花费".

* 添加值标签.
VALUE LABELS ol_shopping 1 "是" 0 "否".
VALUE LABELS e_commerce1 TO e_commerce6 1 "选中" 0 "未选中".

* 定义测量级别.
VARIABLE LEVEL ol_shopping e_commerce1 TO e_commerce6 (NOMINAL).
VARIABLE LEVEL consume (SCALE).

* 对于因跳答而产生的缺失，我们无需在MISSING VALUES中特别定义.
* 在数据录入时，若某受访者在ol_shopping中回答了“0 否”，则其后的e_commerce系列变量和consume变量应直接留空.
* SPSS会自动将这些留空的单元格识别为“系统缺失值”，并在统计分析中正确处理.

EXECUTE.
```
> **辅助知识点：用语法处理跳答逻辑**
> 在数据清理阶段，我们可以使用 `IF` 语句来确保跳答逻辑被严格执行。例如，以下语法会检查所有在Q1回答“否”的个案，并确保他们后续的变量值被设置成系统缺失值。
> ```spss
> IF (ol_shopping = 0) e_commerce1 TO e_commerce6 = $SYSMIS.
> IF (ol_shopping = 0) consume = $SYSMIS.
> EXECUTE.
> ```

![处理跳答题](https://stat4soc.netlify.app/images/3.4.png)

#### 16. 输入数据
*   **点选操作（推荐初学者使用）：** 在完成变量定义后，切换到“数据视图”，像在Excel中一样，在对应的单元格中输入编码后的数值。
*   **语法操作（高级）：** 使用 `BEGIN DATA.` 和 `END DATA.` 命令块，可以直接在语法文件中输入数据，便于分享和复现。

#### 案例（16-1）：创建一个名为edu的数据集，并录入以下数据
| 受访者编号 | 教育程度 | 每月收入 |
| :---: | :---: | :---: |
| 1 | 初中 | 3600 |
| 2 | 大学 | 7000 |
| 3 | 小学 | 9000 |
| 4 | 高中 | 6500 |
| 5 | 大学 | 12000 |
| 6 | 硕士 | 14000 |

```spss
* --- 步骤一：定义变量结构 ---
DATA LIST FREE / id education income.

* --- 步骤二：直接在语法中输入数据 ---
BEGIN DATA.
1 2 3600
2 4 7000
3 1 9000
4 3 6500
5 4 12000
6 5 14000
END DATA.

* --- 步骤三：为变量添加详细定义 ---
DATASET NAME edu.
VARIABLE LABELS 
    id "受访者编号" /
    education "教育程度" /
    income "每月收入".

VALUE LABELS education 
    1 "小学及以下" 
    2 "初中" 
    3 "高中" 
    4 "大学" 
    5 "硕士及以上".

VARIABLE LEVEL 
    id (NOMINAL) /
    education (ORDINAL) / 
    income(SCALE).

EXECUTE.
```

![数据视图](https://stat4soc.netlify.app/images/3.5.png)
![变量视图](https://stat4soc.netlify.app/images/3.6.png)

#### 17. 查看所有变量的基本信息 (Dictionary)
*   `DISPLAY DICTIONARY.` 命令可以快速生成一张包含当前数据集中所有变量信息的列表，包括变量名、标签、格式等，是数据概览的有效工具。
```spss
DISPLAY DICTIONARY.
```

![变量信息列表](https://stat4soc.netlify.app/images/3.7.png)

#### 18. 查看变量的详细编码簿 (Codebook)
*   `CODEBOOK` 命令比 `DISPLAY DICTIONARY` 更进一步，它能提供单个或多个变量极其详尽的信息，包括定义的标签、值标签、缺失值定义，以及位置、类型等元数据，是检查数据定义是否准确无误的最佳工具。
*   **点选操作：** 分析 → 报告 → 代码簿...
*   **语法结构：** `CODEBOOK` + 变量名.
#### 案例（18-1）：查看变量education和income的详细编码信息
```spss
CODEBOOK education income.
```

![Codebook输出](https://stat4soc.netlify.app/images/3.8.png)

#### 19. 查看变量的基本统计量
*   对于不同测量级别的变量，我们应使用不同的命令来查看其统计特征。
*   **分类变量 (名义/有序):** 使用 `FREQUENCIES` 命令查看频数和百分比。
*   **连续变量 (标度):** 使用 `DESCRIPTIVES` 命令查看均值、标准差、最大/最小值等集中和离散趋势指标。

#### 案例（19-1）：查看变量education和income的基本统计信息
```spss
* 对于有序变量education，查看其频数分布是更有意义的.
FREQUENCIES VARIABLES=education.

* 对于标度变量income，查看其描述性统计量.
DESCRIPTIVES VARIABLES=income
	/STATISTICS=MEAN STDDEV MIN MAX.
```
*   **重要提示：** `education` 是一个有序分类变量，其数值（1, 2, 3...）代表等级而非真实数量。因此，计算其“平均受教育程度”在统计学上是没有意义的。我们更关心每个教育等级上有多少人，占比多少。

![描述性统计输出](https://stat4soc.netlify.app/images/3.9.png)

#### 20. 储存数据集
*   **点选操作：** 文件 → 另存为...
*   **语法操作：** 使用 `SAVE OUTFILE` (存为.sav格式) 或 `SAVE TRANSLATE` (存为其他格式)。

#### 案例（20-1）：将当前数据集以压缩的SPSS格式(.sav)存为"demo.sav"
```spss
SAVE OUTFILE = "demo.sav"
	/COMPRESSED.
```
#### 案例（20-2）：储存时剔除变量education，其余存为"demo.sav"
*   `DROP` 子命令用于指定要剔除的变量。
```spss
SAVE OUTFILE = "demo.sav"
	/DROP = education 
	/COMPRESSED.
```
#### 案例（20-3）：储存时仅保留变量income，存为"demo.sav"
*   `KEEP` 子命令用于指定要保留的变量。
```spss
SAVE OUTFILE = "demo.sav"
	/KEEP = income 
	/COMPRESSED.
```
#### 案例（20-4）：将数据存为Stata 14 SE版格式(.dta)
*   `SAVE TRANSLATE` 用于跨格式保存。`/REPLACE` 表示如果已存在同名文件，则覆盖它。
```spss
SAVE TRANSLATE OUTFILE = "demo.dta"
	/TYPE = Stata 
	/VERSION = 14 
	/EDITION = SE
	/REPLACE 
	/KEEP = id income.
```
#### 案例（20-5）：将数据存为Excel格式(.xlsx)
```spss
SAVE TRANSLATE OUTFILE = "demo.xlsx"
	/TYPE = XLS
	/VERSION = 12
	/REPLACE
    /FIELDNAMES
	/CELLS = VALUES 
	/SHEET = "sample"
	/KEEP = id income.
```
